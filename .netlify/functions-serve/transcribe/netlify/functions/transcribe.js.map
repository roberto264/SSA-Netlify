{
  "version": 3,
  "sources": ["../../../../../../../Users/robertoreho/Documents/GitHub/SSA-Netlify/netlify/functions/transcribe.js"],
  "sourceRoot": "/private/var/folders/6p/tnq3q_k96lx9v_thbxh_812w0000gn/T/tmp-32536-bH5yV3Ua2DhP",
  "sourcesContent": ["exports.handler = async (event) => {\n  if (event.httpMethod !== 'POST') {\n    return { statusCode: 405, body: 'Method Not Allowed' };\n  }\n\n  const OPENAI_API_KEY = process.env.OPENAI_API_KEY;\n  \n  if (!OPENAI_API_KEY) {\n    return { statusCode: 500, body: JSON.stringify({ error: 'API Key not configured' }) };\n  }\n\n  try {\n    const { audio } = JSON.parse(event.body);\n    const binaryData = Buffer.from(audio, 'base64');\n    const boundary = '----FormBoundary' + Math.random().toString(36).substring(2);\n    \n    const formParts = [\n      `--${boundary}\\r\\n`,\n      `Content-Disposition: form-data; name=\"file\"; filename=\"audio.webm\"\\r\\n`,\n      `Content-Type: audio/webm\\r\\n\\r\\n`,\n    ];\n    \n    const formEnd = `\\r\\n--${boundary}\\r\\n` +\n      `Content-Disposition: form-data; name=\"model\"\\r\\n\\r\\n` +\n      `whisper-1\\r\\n` +\n      `--${boundary}\\r\\n` +\n      `Content-Disposition: form-data; name=\"language\"\\r\\n\\r\\n` +\n      `de\\r\\n` +\n      `--${boundary}--\\r\\n`;\n\n    const formStart = Buffer.from(formParts.join(''), 'utf8');\n    const formEndBuffer = Buffer.from(formEnd, 'utf8');\n    const fullBody = Buffer.concat([formStart, binaryData, formEndBuffer]);\n\n    const response = await fetch('https://api.openai.com/v1/audio/transcriptions', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': `multipart/form-data; boundary=${boundary}`\n      },\n      body: fullBody\n    });\n\n    const data = await response.json();\n    \n    return {\n      statusCode: 200,\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(data)\n    };\n  } catch (error) {\n    return {\n      statusCode: 500,\n      body: JSON.stringify({ error: error.message })\n    };\n  }\n};\n"],
  "mappings": ";AAAA,QAAQ,UAAU,OAAO,UAAU;AACjC,MAAI,MAAM,eAAe,QAAQ;AAC/B,WAAO,EAAE,YAAY,KAAK,MAAM,qBAAqB;AAAA,EACvD;AAEA,QAAM,iBAAiB,QAAQ,IAAI;AAEnC,MAAI,CAAC,gBAAgB;AACnB,WAAO,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,OAAO,yBAAyB,CAAC,EAAE;AAAA,EACtF;AAEA,MAAI;AACF,UAAM,EAAE,MAAM,IAAI,KAAK,MAAM,MAAM,IAAI;AACvC,UAAM,aAAa,OAAO,KAAK,OAAO,QAAQ;AAC9C,UAAM,WAAW,qBAAqB,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC;AAE5E,UAAM,YAAY;AAAA,MAChB,KAAK,QAAQ;AAAA;AAAA,MACb;AAAA;AAAA,MACA;AAAA;AAAA;AAAA,IACF;AAEA,UAAM,UAAU;AAAA,IAAS,QAAQ;AAAA;AAAA;AAAA;AAAA,IAG1B,QAAQ;AAAA;AAAA;AAAA;AAAA,IAGR,QAAQ;AAAA;AAEf,UAAM,YAAY,OAAO,KAAK,UAAU,KAAK,EAAE,GAAG,MAAM;AACxD,UAAM,gBAAgB,OAAO,KAAK,SAAS,MAAM;AACjD,UAAM,WAAW,OAAO,OAAO,CAAC,WAAW,YAAY,aAAa,CAAC;AAErE,UAAM,WAAW,MAAM,MAAM,kDAAkD;AAAA,MAC7E,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,iBAAiB,UAAU,cAAc;AAAA,QACzC,gBAAgB,iCAAiC,QAAQ;AAAA,MAC3D;AAAA,MACA,MAAM;AAAA,IACR,CAAC;AAED,UAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU,IAAI;AAAA,IAC3B;AAAA,EACF,SAAS,OAAO;AACd,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU,EAAE,OAAO,MAAM,QAAQ,CAAC;AAAA,IAC/C;AAAA,EACF;AACF;",
  "names": []
}
